/*! PDFix license http://pdfix.net/terms. Copyright (c) 2016 Pdfix. All Rights Reserved. */
function AFNumber_Format(n,t,i,r,u,f){var v=event.target,s,a,c,l,h,o,e;if(n<0&&(n=-n),(t<0||t>3)&&(t=0),(i<0||i>3)&&(i=0),s=parseFloat(event.value.replace(",",".")),isNaN(s))e="";else{s>0&&(s+=DOUBLE_CORRECT);a=s<0;c=Math.abs(s).toFixed(n);c.length==0&&(c="0");l=".";h="";switch(t){case 0:h=",";break;case 2:h=".";l=",";break;case 3:l=",";break;case 4:h="'"}o=c.toString().split(".");h.length>0&&(o[0]=o[0].replace(/\B(?=(\d{3})+(?!\d))/g,h));e=o[0];o.length>1&&o[1].length>0&&(e=e+l+o[1]);e=f?u+e:e+u;i!=0?a?((i==2||i==3)&&(e="("+e+")"),(i==1||i==3)&&(v.color=color.red)):v.color=color.black:a&&(e="-"+e)}event.value=e}function AFNumber_Keystroke(n,t){var i=event.value,o=event.change,u,f,s,h,c,r,e,a,l;if(event.willCommit){if(u=trim(i),u.length==0)return;u.replace(",",".");isNaN(u)&&(event.rc=!1,app.alert(ERROR_AFNUMBER_KEYSTROKE));return}if(f="",event.selStart!=-1&&(f=f.substr(event.selStart,event.selEnd-event.selStart)),s=i.charAt(0)=="-"&&f.charAt(0)=="-",s){event.rc=!1;return}for((t<0||t>3)&&(t=0),h=t==2||t==3?",":".",c=i.indexOf(h)!=-1,r=0;r<o.length;r++){if(e=o.charAt(r),e==h){if(c){event.rc=!1;return}c=!0;continue}if(e=="-"){if(s||r!=0||event.selStart!=0){event.rc=!1;return}continue}if(isNaN(parseFloat(e))){event.rc=!1;return}}a=i.substr(0,event.selStart);l="";event.selEnd<i.length&&(l=i.substr(event.selEnd));i=a+o+l;event.value=i}function AFPercent_Format(n,t){var f,s,e,o,u,i,r;n<0&&(n=-n);(t<0||t>3)&&(t=0);f=parseFloat(event.value.replace(",","."));f*=100;n>0&&(f+=DOUBLE_CORRECT);s=f<0;e=Math.abs(f).toFixed(n);e.length==0&&(e="0");o=".";u="";switch(t){case 0:u=",";break;case 2:u=".";o=",";break;case 3:o=",";break;case 4:u="'"}i=e.toString().split(".");u.length>0&&(i[0]=i[0].replace(/\B(?=(\d{3})+(?!\d))/g,u));r=i[0];i.length>1&&i[1].length>0&&(r=r+o+i[1]);s&&(r="-"+r);r+="%";event.value=r}function AFPercent_Keystroke(n,t){return AFNumber_Keystroke(n,t,0,0,"",!0)}function AFDate_FormatEx(n){if(event.value!=""){var t=AFParseDateEx(event.value,n);if(!t){app.alert(util.printf(ERROR_PARSE_DATETIME,event.value));event.rc=!1;return}event.value=util.printd(n,t)}}function AFDate_KeystrokeEx(n){if(typeof event.value!="string"){event.rc=!1;return}if(event.value!=""){var t=AFParseDateEx(event.value,n);if(!t){app.alert(util.printf(ERROR_PARSE_DATETIME,event.value));event.rc=!1;return}return!0}}function AFDate_Format(n){(n<0||n>=oldDateFormats.length)&&(n=0);AFDate_FormatEx(oldDateFormats[n])}function AFDate_Keystroke(n){(n<0||n>=oldDateFormats.length)&&(n=0);AFDate_KeystrokeEx(oldDateFormats[n])}function AFTime_FormatEx(n){if(event.value!=""){var t=AFParseDateEx(event.value,n);if(!t){app.alert(util.printf(ERROR_PARSE_DATETIME,event.value));event.rc=!1;return}event.value=util.printd(n,t)}}function AFTime_KeystrokeEx(n){if(event.value!=""){var t=AFParseDateEx(event.value,n);if(!t){app.alert(util.printf(ERROR_PARSE_DATETIME,event.value));event.rc=!1;return}}}function AFTime_Format(n){(n<0||n>=timeFormats.length)&&(n=0);AFTime_FormatEx(timeFormats[n])}function AFTime_Keystroke(){if(event.value!=""){var n=AFParseDateEx(event.value,cFormat);if(!n){app.alert(util.printf(ERROR_PARSE_DATETIME,event.value));event.rc=!1;return}}}function AFSpecial_Format(n){if(!isNaN(n)){var t=parseInt(event.value);switch(n){case 0:format="99999";break;case 1:format="99999-9999";break;case 2:format=t>999999999?"(999) 999-9999":"999-9999";break;case 3:format="999-99-9999"}typeof format=="string"&&(event.value=util.printx(format,t))}}function AFSpecial_Keystroke(){console.println("AFSpecial_Keystroke not implemented")}function AFSpecial_KeystrokeEx(){console.println("AFSpecial_KeystrokeEx not implemented")}function AFSimple(n,t,i){switch(n){case"AVG":return(t+i)/2;case"SUM":return t+i;case"PRD":return t*i;case"MIN":return Math.min(t,i);case"MAX":return Math.max(t,i)}return t}function AFMakeNumber(n){if(typeof n=="number")return n;var t=0;return typeof n=="string"&&(t=parseFloat(n.replace(",","."))),isNaN(t)&&(t=0),t}function AFSimple_Calculate(n,t){for(var f,e,i=n=="PRD"?1:0,o=AFMakeArrayFromList(t),u=0,r=0;r<o.length;r++)(f=this.getField(o[r]),f!=null)&&(e=AFMakeNumber(f.value),i=r==0&&(n=="MIN"||n=="MAX")?e:AFSimple(n,i,e),u++);u>0&&n=="AVG"&&(i/=u);event.value=i}function AFRange_Validate(n,t,i,r){if(event.value!=""){var o=parseFloat(event.value.replace(",",".")),f=!n||o>=t,e=!i||o<=r,u="";f&&e||(f||e?f?e||(u=util.printf(ERROR_AFRANGE_LT,r)):u=util.printf(ERROR_AFRANGE_GT,t):u=util.printf(ERROR_AFRANGE_GT_AND_LT,t,r),event.rc=!1);u.length>0&&app.alert(u)}}function AFMergeChange(n){if(n.willCommit)return n.value;var i=n.value.substr(0,n.selStart),t="";return n.selEnd>=0&&n.selEnd<val.length&&(t=val.substr(n.selEnd)),i+change+t}function AFParseDateEx(n,t){var r=new Date,i;if(!n)return r;if(dd=1,HH=0,MM=0,SS=0,(dateFormats.findIndex(function(n){return n==t})!=-1||timeFormats.findIndex(function(n){return n==t})!=-1)&&(regex=/^(\d{1,4}|[a-zA-Z]+)(?:[-/:,. ])?(\d{1,4}|[a-zA-Z]+)?(?:[,-:/.])?(?: )?(\d{1,4})?[ ]?(\d{1,2})?[:]?(\d{1,2})?[:]?(\d{1,2})?[ ]?(am|pm)?$/),typeof regex!="undefined"){if(i=n.match(regex),!i)return null;switch(t){case dateFormats[0]:case dateFormats[1]:case dateFormats[2]:case dateFormats[3]:case dateFormats[4]:case dateFormats[18]:case dateFormats[19]:case dateFormats[20]:case dateFormats[21]:case dateFormats[22]:case dateFormats[23]:mm=i[1];dd=i[2];yy=i[3];HH=i[4];MM=i[5];tt=i[7];break;case dateFormats[5]:case dateFormats[6]:case dateFormats[14]:case dateFormats[15]:case dateFormats[16]:case dateFormats[17]:mm=i[1];yy=i[2];break;case dateFormats[7]:case dateFormats[8]:case dateFormats[9]:case dateFormats[10]:case dateFormats[11]:dd=i[1];mm=i[2];yy=i[3];break;case dateFormats[12]:case dateFormats[13]:yy=i[1];mm=i[2];dd=i[3];break;case timeFormats[0]:case timeFormats[1]:case timeFormats[2]:case timeFormats[3]:HH=i[1];MM=i[2];SS=i[3];tt=i[7]}}if(typeof mm!="undefined"){if(isNaN(mm)){if(mm=mm.substr(0,3).toLowerCase(),mm=months.findIndex(function(n){return mm==n.toLowerCase()}),mm<0)return null}else mm=parseInt(mm)-1;r.setMonth(mm)}return typeof dd!="undefined"&&(dd=parseInt(dd),isNaN(dd)||r.setDate(dd)),typeof yy!="undefined"&&(yy=parseInt(yy),!isNaN(yy)||(yy<50?yy+=2e3:yy<100&&(yy+=1900),r.setFullYear(yy))),typeof HH!="undefined"&&(HH=parseInt(HH),isNaN(HH)||(typeof tt=="string"&&HH>12&&tt.toLowerCase()==="pm"&&(HH-=12),r.setHours(HH))),typeof MM!="undefined"&&(MM=parseInt(MM),isNaN(MM)||r.setMinutes(MM)),typeof SS!="undefined"&&(SS=parseInt(SS),isNaN(SS)||r.setSeconds(SS)),r}function AFMakeArrayFromList(n){var t=typeof n;return t=="string"?n.split(","):Array.isArray(n)?n:[]}var DOUBLE_CORRECT=1e-15,ERROR_AFNUMBER_KEYSTROKE="The input value is invalid.",ERROR_AFRANGE_GT_AND_LT="Invalid value: must be greater than or equal to %s and less than or equal to %s.",ERROR_AFRANGE_GT="Invalid value: must be greater than or equal to %s.",ERROR_AFRANGE_LT="Invalid value: must be less than or equal to %s.",ERROR_PARSE_DATETIME="The input value can't be parsed as a valid date/time (%s).",months=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],fullMonths=["January","February","March","April","May","Jun","Jul","August","September","October","November","December"],oldDateFormats=["m/d","m/d/yy","mm/dd/yy","mm/yy","d-mmm","d-mmm-yy","dd-mmm-yy","yy-mm-dd","mmm-yy","mmmm-yy","mmm d, yyyy","mmmm d, yyyy","m/d/yy h:MM tt","m/d/yy HH:MM"],dateFormats=["m/d","m/d/yy","m/d/yyyy","mm/dd/yy","mm/dd/yyyy","mm/yy","mm/yyyy","d-mmm","d-mmm-yy","d-mmm-yyyy","dd-mmm-yy","dd-mmm-yyyy","yy-mm-dd","yyyy-mm-dd","mmm-yy","mmm-yyyy","mmmm-yy","mmmm-yyyy","mmm d, yyyy","mmmm d, yyyy","m/d/yy h:MM tt","","m/d/yyyy h:MM tt","m/d/yy HH:MM","m/d/yyyy HH:MM"],timeFormats=["HH:MM","h:MM tt","HH:MM:ss","h:MM:ss tt"]
